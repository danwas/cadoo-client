{"ast":null,"code":"import _regeneratorRuntime from\"/Users/daniel/Desktop/DH2465-cadoo/code/frontend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/daniel/Desktop/DH2465-cadoo/code/frontend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/daniel/Desktop/DH2465-cadoo/code/frontend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useHistory}from\"react-router-dom\";import{FormGroup,FormControl,ControlLabel}from\"react-bootstrap\";import{useFormFields}from\"../libs/hooksLib\";import{useAuthContext}from\"../libs/Auth\";import LoaderButton from\"../components/LoaderButton\";import\"../css/Login.css\";export default function Login(){var history=useHistory();var _useAuthContext=useAuthContext(),setAuthTokens=_useAuthContext.setAuthTokens;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),authenticated=_useState2[0],setAuthenticated=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],SetEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useFormFields=useFormFields({email:\"\",password:\"\"}),_useFormFields2=_slicedToArray(_useFormFields,2),fields=_useFormFields2[0],handleFieldChange=_useFormFields2[1];function validateForm(){return fields.email.length>0&&fields.password.length>0;}function handleLogin(event){event.preventDefault();if(userAuth(fields.email,fields.password)){setAuthenticated(true);setAuthTokens(fields.email);history.push(\"/\");}else{alert(\"username or password is incorrect!\");}}var userAuth=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,password){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/login\",{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({username:email,password:password})});case 2:res=_context.sent;_context.next=5;return res.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data.success);case 7:case\"end\":return _context.stop();}}},_callee);}));return function userAuth(_x,_x2){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"Login\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleLogin},/*#__PURE__*/React.createElement(FormGroup,{controlId:\"email\",bsSize:\"large\"},/*#__PURE__*/React.createElement(ControlLabel,null),/*#__PURE__*/React.createElement(FormControl,{autoFocus:true,type:\"text\",placeholder:\"name\",value:fields.email,onChange:handleFieldChange})),/*#__PURE__*/React.createElement(FormGroup,{controlId:\"password\",bsSize:\"large\"},/*#__PURE__*/React.createElement(ControlLabel,null),/*#__PURE__*/React.createElement(FormControl,{placeholder:\"password\",value:fields.password,onChange:handleFieldChange,type:\"password\"})),/*#__PURE__*/React.createElement(LoaderButton,{block:true,type:\"submit\",bsSize:\"large\",disabled:!validateForm()},\"Login\")));}","map":{"version":3,"sources":["/Users/daniel/Desktop/DH2465-cadoo/code/frontend/client/src/containers/Login.js"],"names":["React","useState","useHistory","FormGroup","FormControl","ControlLabel","useFormFields","useAuthContext","LoaderButton","Login","history","setAuthTokens","authenticated","setAuthenticated","email","SetEmail","password","setPassword","fields","handleFieldChange","validateForm","length","handleLogin","event","preventDefault","userAuth","push","alert","fetch","method","headers","body","JSON","stringify","username","res","json","data","success"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { FormGroup, FormControl, ControlLabel } from \"react-bootstrap\";\nimport { useFormFields } from \"../libs/hooksLib\";\nimport { useAuthContext } from \"../libs/Auth\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport \"../css/Login.css\";\n\nexport default function Login() {\n  const history = useHistory();\n  const { setAuthTokens } = useAuthContext();\n  const [authenticated, setAuthenticated] = useState(false);\n  const [email, SetEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  const [fields, handleFieldChange] = useFormFields({\n    email: \"\",\n    password: \"\"\n  });\n  \n  function validateForm() {\n    return fields.email.length > 0 && fields.password.length > 0;\n  }\n\n  function handleLogin(event) {\n    event.preventDefault();\n\n    if (userAuth(fields.email, fields.password)) {\n      setAuthenticated(true);\n      setAuthTokens(fields.email);\n      history.push(\"/\");\n      \n    } else {\n      alert(\"username or password is incorrect!\");\n    }\n  }\n\n  const userAuth = async (email, password) => {\n    const res = await fetch(\"/api/login\", {\n      method: 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username: email,\n        password: password\n      })\n    });\n    const data = await res.json();\n    return data.success;\n}\n\n  return (\n    <div className=\"Login\">\n      <form onSubmit={handleLogin}>\n        <FormGroup controlId=\"email\" bsSize=\"large\">\n          <ControlLabel></ControlLabel>\n          <FormControl\n            autoFocus\n            type=\"text\"\n            placeholder=\"name\"\n            value={fields.email}\n            onChange={handleFieldChange}\n          />\n        </FormGroup>\n        <FormGroup controlId=\"password\" bsSize=\"large\">\n          <ControlLabel></ControlLabel>\n          <FormControl\n            placeholder=\"password\"\n            value={fields.password}\n            onChange={handleFieldChange}\n            type=\"password\"\n          />\n        </FormGroup>\n        <LoaderButton\n          block\n          type=\"submit\"\n          bsSize=\"large\"\n          disabled={!validateForm()}\n        >\n          Login\n        </LoaderButton>\n      </form>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}